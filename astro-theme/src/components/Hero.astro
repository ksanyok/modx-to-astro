---
interface Props {
  title?: string;
  subtitle?: string;
  backgroundImage?: string;
  backgroundVideo?: string;
  backgroundPosition?: string;
  overlayOpacity?: number;
  minHeight?: string;
  textAlign?: string;
  verticalAlign?: string;
}

const {
  title = '',
  subtitle = '',
  backgroundImage = '',
  backgroundVideo = '',
  backgroundPosition = 'center',
  overlayOpacity = 40,
  minHeight = 'medium',
  textAlign = 'left',
  verticalAlign = 'bottom',
} = Astro.props;

const heightClasses: Record<string, string> = {
  small: 'min-h-[40vh]',
  medium: 'min-h-[60vh]',
  full: 'min-h-[85vh]',
};

const vAlignClasses: Record<string, string> = {
  top: 'items-start pt-32',
  center: 'items-center',
  bottom: 'items-end pb-20',
};

const tAlignClasses: Record<string, string> = {
  left: 'text-left',
  center: 'text-center',
  right: 'text-right',
};

const hasMedia = !!(backgroundImage || backgroundVideo);
---
<section
  class:list={[
    'relative flex w-full overflow-hidden -mt-16 sm:-mt-[72px] pt-16 sm:pt-[72px]',
    heightClasses[minHeight] || heightClasses.medium,
    vAlignClasses[verticalAlign] || vAlignClasses.bottom,
  ]}
>
  {/* Video background */}
  {backgroundVideo ? (
    <video
      class="absolute inset-0 w-full h-full object-cover hero-bg-animate"
      autoplay
      muted
      loop
      playsinline
      poster={backgroundImage || undefined}
    >
      <source src={backgroundVideo} type="video/mp4" />
    </video>
  ) : backgroundImage ? (
    <div
      class="absolute inset-0 bg-cover bg-no-repeat hero-bg-animate"
      style={`background-image: url('${backgroundImage}'); background-position: ${backgroundPosition};`}
    />
  ) : (
    <Fragment>
      <div class="absolute inset-0 bg-(--color-primary)" />
      <div class="absolute inset-0 bg-gradient-to-br from-white/[0.06] via-transparent to-black/20" />
    </Fragment>
  )}

  {/* Overlay gradient */}
  <div
    class="absolute inset-0"
    style={`background: linear-gradient(to top, rgba(0,0,0,${hasMedia ? 0.55 : 0.15}), rgba(0,0,0,${hasMedia ? (overlayOpacity / 100) * 0.5 : 0.05}));`}
  />

  {/* Content */}
  <div class:list={['relative z-10 w-full max-w-6xl mx-auto px-5 sm:px-6 lg:px-8', tAlignClasses[textAlign] || '']}>
    {subtitle && (
      <p class="hero-subtitle text-base sm:text-lg md:text-xl text-white/80 font-light mb-4 max-w-2xl" set:html={subtitle} />
    )}
    {title && (
      <h1 class="hero-title text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-white leading-[1.1] tracking-tight max-w-4xl" set:html={title} />
    )}
    <slot />
  </div>

  {/* Scroll-down chevron */}
  {(minHeight === 'full') && (
    <a href="#content" class="absolute bottom-8 left-1/2 -translate-x-1/2 z-10 hero-chevron" aria-label="Scroll down">
      <svg class="w-8 h-8 text-white/70" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
      </svg>
    </a>
  )}
</section>

<style>
  @keyframes chevronBounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(8px); }
  }
  .hero-chevron {
    animation: chevronBounce 2s ease-in-out infinite;
  }
</style>
